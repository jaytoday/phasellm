{% extends 'base-navigation.html' %}

{% block bodycontent %}

<p><input type="text" id="form_title" name="form_title" placeholder="Title" style="width:100%;"></p>

<p><input type="text" id="form_groupid" name="form_groupid" placeholder="Group ID" style="width:100%;"></p>

<p><textarea id="form_usermsg" style="width:100%;height:200px" placeholder="Additional user message"></textarea></p>

<p><span class="formfield formfield-hover" onclick="javascript:savejob()">Queue Job</span></p>

<script>
    function savejob() {
        var user_message = document.getElementById("form_usermsg").value;
        var group_id = document.getElementById("form_groupid").value;
        var title = document.getElementById("form_title").value;
        var data = { csrfmiddlewaretoken: '{{ csrf_token }}', user_message: user_message, message_collection_id: group_id, title: title };
        const response = fetch(`create_job`, {
            method: 'POST',
            cache: 'no-cache',
            mode: 'same-origin',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(data => {
                if (data['status'] === "ok") {
                    alert("Saved!");
                } else {
                    alert("Error! " + data['message']);
                }
            })
    }

</script>

{% endblock %}